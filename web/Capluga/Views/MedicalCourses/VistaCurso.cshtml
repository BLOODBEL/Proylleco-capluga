@model IEnumerable<Capluga.Entities.CursoEnt>

@{
    ViewBag.Title = "Productos";
    Layout = "~/Views/Shared/_Layout.cshtml";
}



<div class="row mt-3 justify-content-center" id="Container">

    @if (Model != null)
    {
        foreach (var item in Model)
        {
            <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4 d-flex align-items-stretch">
                <div class="card text-center w-100">
                    <div class="card-body">
                        <img src="@item.Image" width="150" height="150">
                        <br /><br />
                        <h5 class="card-title">@item.Name</h5>
                        <p class="card-text">@item.Description</p>
                        <p class="card-text">Fecha Del Curso:@item.DateandTime</p>
                        <p class="card-text">Cupos: @item.Quantity - @item.Price.ToString("C", new System.Globalization.CultureInfo("es-CR"))</p>
                        @if (Session["UserID"] != null)
                        {
                            <div class="row">
                                <div class="col-3">

                                </div>
                                <div class="col-4" style="text-align:right!important">
                                    <input id=prd-@item.MedicalCourseID type="number" class="form-control">
                                </div>
                                <div class="col-4" style="text-align:left">



                                    <a onclick="RegistrarInscripcion(@item.MedicalCourseID, @item.Quantity)" class="btn btn-info"><i class="fa fa-cart-plus"></i></a>


                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        }

    }
    else
    {
        <div class="col-12 alert alert-info" role="alert" style="text-align: center; margin-top: 5%;">
            No hay productos registrados en este momento
        </div>
    }

</div>



<script>

    function RegistrarInscripcion(medicalCourseID, disponible) {
        let quantity = $("#prd-" + medicalCourseID).val();

        if (quantity > disponible) {

          alert("Su solicitud supera la cantidad de unidades disponibles");

      }
      else {

            $.ajax({
                url: '/Registeredcourses/RegistrarInscripcion',
            type: "GET",
            data:
            {
                "quantity": quantity,
                "medicalCourseID": medicalCourseID
            },
            success: function (data) {
               window.location.href = '@Url.Action("VistaCurso", "MedicalCourses")';
            }
        });

      }
  }

</script>